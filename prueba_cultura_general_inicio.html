<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Quiz CRG – Cultura General (Prueba 1)</title>
<style>
  :root{
    --crg-green:#007853; --crg-yellow:#F3CA12; --dark:#032821; --light:#ffffff;
  }
  *{box-sizing:border-box}
  body{
    margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial,"Open Sans",sans-serif;
    background:linear-gradient(180deg,var(--dark),#064536);
    color:var(--light);min-height:100dvh;
  }
  .wrap{max-width:900px;margin:0 auto;padding:clamp(16px,3vw,32px)}
  header{display:flex;align-items:center;gap:16px;margin-bottom:20px}
  .badge{background:var(--crg-yellow);color:#1a1a1a;font-weight:700;padding:6px 10px;border-radius:999px;font-size:.85rem}
  h1{margin:0;font-size:clamp(22px,3.5vw,32px);font-weight:800}
  .card{background:#0d2f28;border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:18px;margin:14px 0;box-shadow:0 8px 24px rgba(0,0,0,.25)}
  .q-title{font-weight:700;margin-bottom:10px}
  .options{display:grid;gap:10px}
  .opt{background:#0f3a31;border:1px solid rgba(255,255,255,.07);border-radius:12px;padding:10px 12px;display:flex;gap:10px;align-items:flex-start;cursor:pointer}
  .opt input{margin-top:4px;accent-color:var(--crg-yellow)}
  .hint{font-size:.85rem;color:#d2d2d2;margin-top:4px}
  .tbd{color:#ffd966;font-weight:700}
  .actions{display:flex;gap:12px;flex-wrap:wrap;align-items:center;margin-top:18px}
  button{background:var(--crg-green);color:var(--light);border:none;padding:12px 18px;border-radius:12px;font-weight:800;cursor:pointer;letter-spacing:.2px}
  button.secondary{background:transparent;border:1px solid rgba(255,255,255,.2)}
  .result{display:none;margin-top:20px;padding:16px;border-radius:14px;background:#0b2a24;border:1px solid rgba(255,255,255,.1)}
  .code-box{font-size:2.5rem;font-weight:900;color:var(--crg-yellow);text-align:center;letter-spacing:4px;margin-top:8px}
  footer{margin-top:28px;font-size:.85rem;color:#cfeee5;opacity:.9;text-align:center}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <span class="badge">Prueba 1</span>
    <h1>Quiz · Cultura General · Caixa Rural Galega</h1>
  </header>

  <div id="quiz"></div>

  <div class="actions">
    <button id="btnSubmit">Enviar respuestas</button>
    <button id="btnClear" class="secondary">Limpiar</button>
  </div>

  <div id="result" class="result"></div>

  <footer>
    CRG · Cena de Navidad · Juego “Caja Fuerte”
  </footer>
</div>

<script>
const QUESTIONS = [
  {
    text: "¿Cuál es la edad media del Consejo Rector?",
    options: ["73", "84", "61", "46"],
    correct: 3
  },
  {
    text: "¿Cuántos atracos se llevan registrados en CRG en todos sus años de historia?",
    options: ["6", "4", "10", "12"],
    correct: null
  },
  {
    text: "¿Cuál fue el beneficio neto de la Caja en el año 2024?",
    options: ["32.146.758,45€", "31.843.733,12€", "33.450.124,73€", "29.365.100,37€"],
    correct: 2
  },
  {
    text: "¿En qué año la Entidad pasó a llamarse Caixa Rural Galega?",
    options: ["1999", "1995", "2001", "1993"],
    correct: 1
  },
  {
    text: "¿Cuántos rollos de TPV se usan de media al año?",
    options: ["19.000", "20.000", "17.000", "29.000"],
    correct: 2
  },
  {
    text: "Indica el número de personas que se han incorporado a la plantilla en el año 2025.",
    options: ["13", "10", "3", "9"],
    correct: 2
  },
  {
    text: "¿Cuál es el nombre más repetido entre los empleados de Caixa Rural Galega, si solo contamos los nombres no compuestos (sin segundas partes como “José Manuel” o “María del Carmen”)?",
    options: ["Silvia", "Javier", "Mónica", "Verónica"],
    correct: 4
  }
];

const quizEl = document.getElementById("quiz");
const btnSubmit = document.getElementById("btnSubmit");
const btnClear = document.getElementById("btnClear");
const resultEl = document.getElementById("result");

// Barajar array (Fisher–Yates)
function shuffle(array){
  for(let i=array.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [array[i],array[j]]=[array[j],array[i]];
  }
  return array;
}

function renderQuiz(){
  quizEl.innerHTML="";
  const shuffledQuestions = shuffle([...QUESTIONS]);
  shuffledQuestions.forEach((q, qi)=>{
    const card=document.createElement("div");
    card.className="card";
    const title=document.createElement("div");
    title.className="q-title";
    title.textContent=`${qi+1}. ${q.text}`;
    card.appendChild(title);

    const opts=document.createElement("div");
    opts.className="options";
    const optionIndexes = shuffle([0,1,2,3].slice(0, q.options.length));
    optionIndexes.forEach(oi=>{
      const label=document.createElement("label");
      label.className="opt";
      const input=document.createElement("input");
      input.type="radio";
      input.name=`q-${qi}`;
      input.value=oi;
      label.appendChild(input);
      const span=document.createElement("span");
      span.textContent=q.options[oi];
      label.appendChild(span);
      opts.appendChild(label);
    });
    card.appendChild(opts);

    if(q.correct===null){
      const hint=document.createElement("p");
      hint.className="hint";
      hint.innerHTML="⚠️ <span class='tbd'>Respuesta pendiente</span>. No puntúa de momento.";
      card.appendChild(hint);
    }

    quizEl.appendChild(card);
  });
}

function getScore(){
  let score=0, totalDef=0;
  const cards = document.querySelectorAll(".card");
  cards.forEach((card, qi)=>{
    const q = QUESTIONS[qi];
    if(typeof q.correct==="number"){
      totalDef++;
      const checked = card.querySelector("input:checked");
      if(checked && Number(checked.value)===q.correct){score++;}
    }
  });
  return {score,totalDef};
}

btnSubmit.addEventListener("click",()=>{
  const {score,totalDef}=getScore();
  resultEl.style.display="block";
  if(score>=5){
    const d1 = score % 10;
    resultEl.innerHTML = `
      <h2>¡Muy bien!</h2>
      <p>Has acertado <strong>${score}</strong> de ${totalDef} preguntas.</p>
      <p>Tu primer dígito del código es:</p>
      <div class="code-box">${d1}</div>
    `;
  } else {
    resultEl.innerHTML = `
      <h2>¡Casi!</h2>
      <p>Has acertado ${score} de ${totalDef} preguntas. Necesitas al menos 5 para conseguir el dígito.</p>
      <button id="retryBtn">Volver a intentar</button>
    `;
    document.getElementById("retryBtn").addEventListener("click",()=>{
      resultEl.style.display="none";
      renderQuiz();
    });
  }
  resultEl.scrollIntoView({behavior:"smooth"});
});

btnClear.addEventListener("click",()=>{
  document.querySelectorAll('input[type="radio"]').forEach(r=>r.checked=false);
  resultEl.style.display="none";
});

renderQuiz();
</script>
</body>
</html>
